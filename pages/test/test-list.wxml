<!-- pages/test/test-list.wxml -->


<view class="container" bindtouchstart="touchStart" bindtouchmove="touchMove" bindtouchend="touchEnd">
  <view class="header">
    <view class="title">
      <image class="title-icon" src="/images/icons/homeicon1.png" mode="aspectFit"></image>
      <text class="title-text">所有测试</text>
    </view>
  </view>

  <view class="section-header">
    <text class="section-subtitle">选择一个测试开始</text>
  </view>
  
  <!-- 返回主页按钮 -->
  <view class="home-btn {{isDragging ? 'home-btn-dragging' : ''}}" bindtap="backToHome" style="top: {{btnPosition.y}}px; left: {{btnPosition.x}}px; right: auto;" bindtouchmove="dragButton" data-type="home">
    <text>返回</text>
  </view> 
  
  <!-- 按类型分类显示测试 -->
  <view class="test-categories">
    <block wx:for="{{categorizedTests}}" wx:key="type" wx:for-item="category">
      <!-- 分类标题 -->
      <view class="category-header" bindtap="toggleCategory" data-type="{{category.type}}">
        <text class="category-title">{{category.typeName}}</text>
        <text class="category-toggle">{{categoryCollapsed[category.type] ? '>' : '▼'}}</text>
      </view>
      
      <!-- 该分类下的测试列表 -->
      <view class="test-grid test-grid-2x2" hidden="{{categoryCollapsed[category.type]}}">
        <block wx:for="{{category.tests}}" wx:key="id">
          <button class="test-btn" hover-class="btn-hover" bindtap="goToTest" data-id="{{item.id}}" data-key="{{item.key}}">
            <view class="btn-text-container">
              <text class="{{item.needScroll ? 'scrolling-text' : 'btn-text'}}">{{item.titleshort}}</text>
            </view>
          </button>
        </block>
      </view>
    </block>
  </view>
</view>