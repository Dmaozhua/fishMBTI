<!-- /pages/test/test.wxml -->



<view class="container" bindtouchstart="touchStart" bindtouchmove="touchMove" bindtouchend="touchEnd" catch:touchmove="true">
  <!-- æ ‡é¢˜ -->
  <view class="title-box">
    <text class="title">{{testData.title}}</text>
  </view>
<!-- è¿›åº¦æ¡ -->
<view class="progress-bar-wrapper">
    <view class="progress-bar-container">
        <view class="progress-bar">
            <view class="progress-bar-inner" style="width: {{progress + '%'}}"></view>
        </view>
        <text class="progress-text">å½“å‰æŠ›ç«¿è¿›åº¦ {{currentQuestion.id}} / {{totalQuestions}}</text>
    </view>
</view>
<!-- é—®é¢˜åŒºåŸŸå¢åŠ åºå·æ ‡è¯† -->
<view class="question-header">
  <text class="question-number">é—®é¢˜ {{currentQuestion.id}}</text>
  <!-- <text class="question-tag">{{testData.tag || 'å¿ƒç†æµ‹è¯„'}}</text> -->
</view>
<!-- é—®é¢˜å†…å®¹ -->
<view class="question-content">
    <text class="question-text">{{currentQuestion.text}}</text>
</view>

<!-- é€‰é¡¹åˆ—è¡¨ -->
<view class="options-box">
    <block wx:for="{{currentQuestion.options}}" wx:key="index">
        <view 
            class="option-item {{selectedIndex === index ? 'active' : ''}}"
    bindtap="handleAutoNext"
    data-index="{{index}}">
    <text class="option-text">{{item.text}}</text>
        </view>
    </block>
</view>


<!-- å¯¼èˆªæŒ‰é’® -->
<view class="nav-buttons">
    <view class="nav-btn prev-btn {{currentQuestion.id > 1 ? '' : 'disabled'}}" bindtap="goPrev">
        <text>ä¸Šä¸€é¢˜</text>
    </view>
    <view class="nav-btn next-btn {{selectedIndex !== null ? '' : 'disabled'}}" bindtap="goNext">
        <text>ä¸‹ä¸€é¢˜</text>
    </view>
</view>
<!-- åº•éƒ¨å¯¼èˆªæ å¢åŠ å®‰å…¨åŒºåŸŸé€‚é… -->
<view class="nav-buttons safe-area"></view>
  <!-- è¿”å›ä¸»é¡µæŒ‰é’® -->
  <!-- <view class="home-btn" bindtap="backToHome">
    <text>è¿”å›</text>
  </view> -->

  <!-- ç»“æœå¼¹çª— -->
  <view wx:if="{{showResult}}" class="result-modal">
    <view class="result-content">
      <text class="result-title">{{resultData.title || resultData.type}}</text>
      <text wx:if="{{resultData.resultPercentage}}" class="result-percentage">å‡ºç°æ¦‚ç‡ï¼š{{resultData.resultPercentage}}%</text>
      
      <!-- äººæ ¼ç”»åƒ -->
      <view class="section-container">
        <text class="section-title">ğŸ‘¤ äººæ ¼ç”»åƒ</text>
        <text class="result-desc">{{resultData.description || resultData.desc}}</text>
      </view>
      
      <!-- AIå»ºè®® -->
      <view class="section-container" wx:if="{{resultData.suggestion}}">
        <text class="section-title">ğŸ§  AIå»ºè®®</text>
        <text class="result-desc">{{resultData.suggestion}}</text>
      </view>
      
      <!-- è£…å¤‡æ¨è -->
      <view class="recommend-section">
        <text class="recommend-title">ğŸ¯ è£…å¤‡æ¨è</text>
        <block wx:if="{{resultData.equip}}">
          <text class="result-desc">{{resultData.equip}}</text>
        </block>
        <block wx:else>
          <block wx:for="{{resultData.recommend}}" wx:key="index">
            <view class="recommend-item">{{item}}</view>
          </block>
        </block>
      </view>

      <button class="result-btn" bindtap="backToHome">è¿”å›é¦–é¡µ</button>
    </view>
  </view>
</view>